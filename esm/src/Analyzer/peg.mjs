import AnalyzerToken from"./AnalyzerToken.mjs";const peggyParser=function(){"use strict";function st(t,r,e,n){t=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(t,st.prototype),t.expected=r,t.found=e,t.location=n,t.name="SyntaxError",t}function t(){this.constructor=r}var r,e;function l(t,r,e){return e=e||" ",t.length>r?t:(r-=t.length,t+(e+=e.repeat(r)).slice(0,r))}return r=st,e=Error,t.prototype=e.prototype,r.prototype=new t,st.prototype.format=function(t){var r="Error: "+this.message;if(this.location){for(var e=null,n=0;n<t.length;n++)if(t[n].source===this.location.source){e=t[n].text.split(/\r\n|\n|\r/g);break}var o,a,c,u=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(u):u,i=this.location.source+":"+s.line+":"+s.column;e?(c=this.location.end,o=l("",s.line.toString().length," "),a=e[u.line-1],c=(u.line===c.line?c.column:a.length+1)-u.column||1,r+="\n --\x3e "+i+"\n"+o+" |\n"+s.line+" | "+a+"\n"+o+" | "+l("",u.column-1," ")+l("",c,"^")):r+="\n at "+i}return r},st.buildMessage=function(t,r){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r=t.parts.map(function(t){return Array.isArray(t)?a(t[0])+"-"+a(t[1]):a(t)});return"["+(t.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function c(t){return e[t.type](t)}return"Expected "+function(t){var r,e,n=t.map(c);if(n.sort(),0<n.length){for(e=r=1;r<n.length;r++)n[r-1]!==n[r]&&(n[e]=n[r],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+((t=r)?'"'+o(t)+'"':"end of input")+" found."},{SyntaxError:st,parse:function(c,t){function T(t){return t.map(t=>-1<["\\'","\\\\"].indexOf(t)?t[1]:t).join("")}function M(t){return t.map(t=>-1<['\\"',"\\\\"].indexOf(t)?t[1]:t).join("")}function U(t){return t.map(([,t])=>-1<["\\`","\\\\"].indexOf(t)?t[1]:t).join("")}function q(t){return[t[0],...t[1]].join("")}var u={},a=(t=void 0!==t?t:{}).grammarSource,r={Start:ct},e=ct,B="(",s="'",i="\\'",l="\\\\",f='"',h='\\"',p="`",g="${",A="\\`",y=/^[^a-zA-Z_$]/,D=/^[,)]/,n=/^[ \t\r\n]/,d=/^[^']/,x=/^[^"]/,m=/^[^`]/,G=/^[a-zA-Z_$]/,b=/^[a-zA-Z0-9_$]/,v=Z([["a","z"],["A","Z"],"_","$"],!0,!1),C={type:"any"},H=O("(",!1),I=Z([",",")"],!1,!1),o=Z([" ","\t","\r","\n"],!1,!1),E=O("'",!1),J=O("\\'",!1),z=O("\\\\",!1),K=Z(["'"],!0,!1),L=O('"',!1),N=O('\\"',!1),Q=Z(['"'],!0,!1),V=O("`",!1),W=O("${",!1),X=O("\\`",!1),Y=Z(["`"],!0,!1),tt=Z([["a","z"],["A","Z"],"_","$"],!1,!1),rt=Z([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1),et=function(t){return t.flat().filter(t=>t instanceof AnalyzerToken)},nt=function(t,r){return new AnalyzerToken(t,r,c.substring(j,S),_(j,S))},S=0,j=0,F=[{line:1,column:1}],P=0,$=[],w=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');e=r[t.startRule]}function O(t,r){return{type:"literal",text:t,ignoreCase:r}}function Z(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function ot(t){var r,e=F[t];if(e)return e;for(r=t-1;!F[r];)r--;for(e={line:(e=F[r]).line,column:e.column};r<t;)10===c.charCodeAt(r)?(e.line++,e.column=1):e.column++,r++;return F[t]=e}function _(t,r,e){var n=ot(t),o=ot(r),t={source:a,start:{offset:t,line:n.line,column:n.column},end:{offset:r,line:o.line,column:o.column}};return e&&a&&"function"==typeof a.offset&&(t.start=a.offset(t.start),t.end=a.offset(t.end)),t}function k(t){S<P||(P<S&&(P=S,$=[]),$.push(t))}function at(t,r,e){return new st(st.buildMessage(t,r),t,r,e)}function ct(){var t,r,e=S,n=[],o=S;for(y.test(c.charAt(S))?(t=c.charAt(S),S++):(t=u,0===w&&k(v)),t===u&&(t=null),(o=(r=ut())!==u?t=[t,r]:(S=o,u))===u&&(c.length>S?(o=c.charAt(S),S++):(o=u,0===w&&k(C)));o!==u;)n.push(o),o=S,y.test(c.charAt(S))?(t=c.charAt(S),S++):(t=u,0===w&&k(v)),t===u&&(t=null),(o=(r=ut())!==u?t=[t,r]:(S=o,u))===u&&(c.length>S?(o=c.charAt(S),S++):(o=u,0===w&&k(C)));return j=e,n=et(n)}function ut(){var t,r,e=S,n=function(){var t,r,e,n,o;r=t=S,G.test(c.charAt(S))?(e=c.charAt(S),S++):(e=u,0===w&&k(tt));if(e!==u){for(n=[],b.test(c.charAt(S))?(o=c.charAt(S),S++):(o=u,0===w&&k(rt));o!==u;)n.push(o),b.test(c.charAt(S))?(o=c.charAt(S),S++):(o=u,0===w&&k(rt));r=e=[e,n]}else S=r,r=u;r!==u&&(j=t,r=q(r));return t=r}();return e=n!==u&&(R(),40===c.charCodeAt(S)?(t=B,S++):(t=u,0===w&&k(H)),t!==u)&&(R(),(t=function(){var t,r,e,n,o,a;t=S,39===c.charCodeAt(S)?(r=s,S++):(r=u,0===w&&k(E));if(r!==u){for(e=[],c.substr(S,2)===i?(n=i,S+=2):(n=u,0===w&&k(J)),n===u&&(c.substr(S,2)===l?(n=l,S+=2):(n=u,0===w&&k(z)),n===u)&&(d.test(c.charAt(S))?(n=c.charAt(S),S++):(n=u,0===w&&k(K)));n!==u;)e.push(n),c.substr(S,2)===i?(n=i,S+=2):(n=u,0===w&&k(J)),n===u&&(c.substr(S,2)===l?(n=l,S+=2):(n=u,0===w&&k(z)),n===u)&&(d.test(c.charAt(S))?(n=c.charAt(S),S++):(n=u,0===w&&k(K)));39===c.charCodeAt(S)?(n=s,S++):(n=u,0===w&&k(E)),t=n!==u?(j=t,T(e)):(S=t,u)}else S=t,t=u;if(t===u){if(t=S,34===c.charCodeAt(S)?(r=f,S++):(r=u,0===w&&k(L)),r!==u){for(e=[],c.substr(S,2)===h?(n=h,S+=2):(n=u,0===w&&k(N)),n===u&&(c.substr(S,2)===l?(n=l,S+=2):(n=u,0===w&&k(z)),n===u)&&(x.test(c.charAt(S))?(n=c.charAt(S),S++):(n=u,0===w&&k(Q)));n!==u;)e.push(n),c.substr(S,2)===h?(n=h,S+=2):(n=u,0===w&&k(N)),n===u&&(c.substr(S,2)===l?(n=l,S+=2):(n=u,0===w&&k(z)),n===u)&&(x.test(c.charAt(S))?(n=c.charAt(S),S++):(n=u,0===w&&k(Q)));34===c.charCodeAt(S)?(n=f,S++):(n=u,0===w&&k(L)),t=n!==u?(j=t,M(e)):(S=t,u)}else S=t,t=u;if(t===u)if(t=S,96===c.charCodeAt(S)?(r=p,S++):(r=u,0===w&&k(V)),r!==u){for(e=[],o=n=S,w++,c.substr(S,2)===g?(a=g,S+=2):(a=u,0===w&&k(W)),w--,o=a===u?void 0:(S=o,u),n=o!==u&&(c.substr(S,2)===A?(a=A,S+=2):(a=u,0===w&&k(X)),a===u&&(c.substr(S,2)===l?(a=l,S+=2):(a=u,0===w&&k(z)),a===u)&&(m.test(c.charAt(S))?(a=c.charAt(S),S++):(a=u,0===w&&k(Y))),a!==u)?o=[o,a]:(S=n,u);n!==u;)e.push(n),o=n=S,w++,c.substr(S,2)===g?(a=g,S+=2):(a=u,0===w&&k(W)),w--,o=a===u?void 0:(S=o,u),n=o!==u&&(c.substr(S,2)===A?(a=A,S+=2):(a=u,0===w&&k(X)),a===u&&(c.substr(S,2)===l?(a=l,S+=2):(a=u,0===w&&k(z)),a===u)&&(m.test(c.charAt(S))?(a=c.charAt(S),S++):(a=u,0===w&&k(Y))),a!==u)?o=[o,a]:(S=n,u);96===c.charCodeAt(S)?(n=p,S++):(n=u,0===w&&k(V)),t=n!==u?(j=t,U(e)):(S=t,u)}else S=t,t=u}return t}())!==u)&&(R(),D.test(c.charAt(S))?(r=c.charAt(S),S++):(r=u,0===w&&k(I)),r!==u)?(j=e,nt(n,t)):(S=e,u)}function R(){var t,r=[];for(n.test(c.charAt(S))?(t=c.charAt(S),S++):(t=u,0===w&&k(o));t!==u;)r.push(t),n.test(c.charAt(S))?(t=c.charAt(S),S++):(t=u,0===w&&k(o));return r}if((r=e())!==u&&S===c.length)return r;throw r!==u&&S<c.length&&k({type:"end"}),at($,P<c.length?c.charAt(P):null,P<c.length?_(P,P+1):_(P,P))}}}(),parse=(peggyParser.SyntaxError.prototype.name="PeggySyntaxError",peggyParser.parse),PeggySyntaxError=peggyParser.SyntaxError;export default parse;