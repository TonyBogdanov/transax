"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const AnalyzerToken_1=require("./AnalyzerToken");function peg$padEnd(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,t+(r+=r.repeat(e)).slice(0,e))}class PeggySyntaxError extends Error{static buildMessage(t,e){function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function n(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+r(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+r(t))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+r(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+r(t))}function c(t){switch(t.type){case"literal":return'"'+n(t.text)+'"';case"class":var e=t.parts.map(t=>Array.isArray(t)?a(t[0])+"-"+a(t[1]):a(t));return"["+(t.inverted?"^":"")+e+"]";case"any":return"any character";case"end":return"end of input";case"other":return t.description}}return"Expected "+function(t){var e=t.map(c);let r,n;if(e.sort(),0<e.length){for(r=1,n=1;r<e.length;r++)e[r-1]!==e[r]&&(e[n]=e[r],n++);e.length=n}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(t)+" but "+((t=e)?'"'+n(t)+'"':"end of input")+" found."}constructor(t,e,r,n){super(),this.message=t,this.expected=e,this.found=r,this.location=n,this.name="PeggySyntaxError","function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(this,PeggySyntaxError.prototype):this.__proto__=PeggySyntaxError.prototype,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,PeggySyntaxError)}format(r){let n="Error: "+this.message;if(this.location){let t=null,e;for(e=0;e<r.length;e++)if(r[e].grammarSource===this.location.source){t=r[e].text.split(/\r\n|\n|\r/g);break}var a,c,o,u=this.location.start,s=this.location.source+":"+u.line+":"+u.column;t?(o=this.location.end,a=peg$padEnd("",u.line.toString().length," "),c=t[u.line-1],o=u.line===o.line?o.column:c.length+1,n+="\n --\x3e "+s+"\n"+a+" |\n"+u.line+" | "+c+"\n"+a+" | "+peg$padEnd("",u.column-1," ")+peg$padEnd("",o-u.column,"^")):n+="\n at "+s}return n}}function peg$parse(o,t){const u={},R=(t=void 0!==t?t:{}).grammarSource;var e={Start:ot};let r=ot;function M(t){return t.map(t=>"\\'"===t?t[1]:t).join("")}function q(t){return t.map(t=>'\\"'===t?t[1]:t).join("")}function U(t){return t.map(([,t])=>"\\`"===t?t[1]:t).join("")}const B=function(t){return t.flat().filter(t=>t instanceof AnalyzerToken_1.default)},D="(",G=k("(",!1),H=/^[,)]/,I=w([",",")"],!1,!1),J=function(t,e){return new AnalyzerToken_1.default(t,e,rt(),nt().start.line,nt().start.column)},n=/^[ \t\r\n]/,a=w([" ","\t","\r","\n"],!1,!1),K=/^[^a-zA-Z_$]/,L=w([["a","z"],["A","Z"],"_","$"],!0,!1),N={type:"any"},Q=/^[a-zA-Z_$]/,V=w([["a","z"],["A","Z"],"_","$"],!1,!1),c=/^[a-zA-Z_$0-9]/,s=w([["a","z"],["A","Z"],"_","$",["0","9"]],!1,!1),W=rt,l="'",i=k("'",!1),h="\\'",p=k("\\'",!1),f=/^[^']/,g=w(["'"],!0,!1),A='"',d=k('"',!1),y='\\"',x=k('\\"',!1),m=/^[^"]/,E=w(['"'],!0,!1),b="`",_=k("`",!1),S="${",X=k("${",!1),$="\\`",Y=k("\\`",!1),tt=/^[^`]/,et=w(["`"],!0,!1);let v=0,C=0;const z=[{line:1,column:1}];let P=0,F=[],j=0;if(void 0!==t.startRule){if(!(t.startRule in e))throw new Error("Can't start parsing from rule \""+t.startRule+'".');r=e[t.startRule]}function rt(){return o.substring(C,v)}function nt(){return T(C,v)}function k(t,e){return{type:"literal",text:t,ignoreCase:e}}function w(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function at(t){var e=z[t];let r;if(e)return e;for(r=t-1;!z[r];)r--;for(e={line:(e=z[r]).line,column:e.column};r<t;)10===o.charCodeAt(r)?(e.line++,e.column=1):e.column++,r++;return z[t]=e}function T(t,e){var r=at(t),n=at(e);return{source:R,start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function Z(t){v<P||(v>P&&(P=v,F=[]),F.push(t))}function ct(t,e,r){return new PeggySyntaxError(PeggySyntaxError.buildMessage(t,e),t,e,r)}function ot(){let t,e,r,n,a;for(t=v,e=[],r=v,(n=st())===u&&(n=null),(r=n!==u&&(a=ut())!==u?n=[n,a]:(v=r,u))===u&&(r=lt());r!==u;)e.push(r),r=v,(n=st())===u&&(n=null),(r=n!==u&&(a=ut())!==u?n=[n,a]:(v=r,u))===u&&(r=lt());return e!==u&&(C=t,e=B(e)),e}function ut(){let t,e,r,n,a;return t=v,e=function(){let t,e,r,n;t=v,Q.test(o.charAt(v))?(e=o.charAt(v),v++):(e=u,0===j&&Z(V));if(e!==u){for(r=[],c.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(s));n!==u;)r.push(n),c.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(s));t=r!==u?(C=t,e=W()):(v=t,u)}else v=t,t=u;return t}(),t=e!==u&&O()!==u&&(40===o.charCodeAt(v)?(r=D,v++):(r=u,0===j&&Z(G)),r!==u)&&O()!==u&&(n=function(){let t,e,r,n,a,c;t=v,39===o.charCodeAt(v)?(e=l,v++):(e=u,0===j&&Z(i));if(e!==u){for(r=[],o.substr(v,2)===h?(n=h,v+=2):(n=u,0===j&&Z(p)),n===u&&(f.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(g)));n!==u;)r.push(n),o.substr(v,2)===h?(n=h,v+=2):(n=u,0===j&&Z(p)),n===u&&(f.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(g)));t=r!==u&&(39===o.charCodeAt(v)?(n=l,v++):(n=u,0===j&&Z(i)),n!==u)?(C=t,e=M(r)):(v=t,u)}else v=t,t=u;if(t===u){if(t=v,34===o.charCodeAt(v)?(e=A,v++):(e=u,0===j&&Z(d)),e!==u){for(r=[],o.substr(v,2)===y?(n=y,v+=2):(n=u,0===j&&Z(x)),n===u&&(m.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(E)));n!==u;)r.push(n),o.substr(v,2)===y?(n=y,v+=2):(n=u,0===j&&Z(x)),n===u&&(m.test(o.charAt(v))?(n=o.charAt(v),v++):(n=u,0===j&&Z(E)));t=r!==u&&(34===o.charCodeAt(v)?(n=A,v++):(n=u,0===j&&Z(d)),n!==u)?(C=t,e=q(r)):(v=t,u)}else v=t,t=u;if(t===u)if(t=v,96===o.charCodeAt(v)?(e=b,v++):(e=u,0===j&&Z(_)),e!==u){for(r=[],n=v,a=v,j++,o.substr(v,2)===S?(c=S,v+=2):(c=u,0===j&&Z(X)),j--,a=c===u?void 0:(v=a,u),n=a!==u&&(o.substr(v,2)===$?(c=$,v+=2):(c=u,0===j&&Z(Y)),c===u&&(tt.test(o.charAt(v))?(c=o.charAt(v),v++):(c=u,0===j&&Z(et))),c!==u)?a=[a,c]:(v=n,u);n!==u;)r.push(n),n=v,a=v,j++,o.substr(v,2)===S?(c=S,v+=2):(c=u,0===j&&Z(X)),j--,a=c===u?void 0:(v=a,u),n=a!==u&&(o.substr(v,2)===$?(c=$,v+=2):(c=u,0===j&&Z(Y)),c===u&&(tt.test(o.charAt(v))?(c=o.charAt(v),v++):(c=u,0===j&&Z(et))),c!==u)?a=[a,c]:(v=n,u);t=r!==u&&(96===o.charCodeAt(v)?(n=b,v++):(n=u,0===j&&Z(_)),n!==u)?(C=t,e=U(r)):(v=t,u)}else v=t,t=u}return t}())!==u&&O()!==u&&(H.test(o.charAt(v))?(a=o.charAt(v),v++):(a=u,0===j&&Z(I)),a!==u)?(C=t,J(e,n)):(v=t,u)}function O(){let t,e;for(t=[],n.test(o.charAt(v))?(e=o.charAt(v),v++):(e=u,0===j&&Z(a));e!==u;)t.push(e),n.test(o.charAt(v))?(e=o.charAt(v),v++):(e=u,0===j&&Z(a));return t}function st(){let t;return K.test(o.charAt(v))?(t=o.charAt(v),v++):(t=u,0===j&&Z(L)),t}function lt(){let t;return o.length>v?(t=o.charAt(v),v++):(t=u,0===j&&Z(N)),t}if((e=r())!==u&&v===o.length)return e;throw e!==u&&v<o.length&&Z({type:"end"}),ct(F,P<o.length?o.charAt(P):null,P<o.length?T(P,P+1):T(P,P))}const parse=peg$parse;exports.default=parse;