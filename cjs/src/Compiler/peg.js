"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const TextToken_1=require("./TextToken"),LiteralToken_1=require("./LiteralToken"),BracketSafeExpressionToken_1=require("./BracketSafeExpressionToken"),TernaryExpressionToken_1=require("./TernaryExpressionToken"),ComparisonExpressionToken_1=require("./ComparisonExpressionToken"),CallExpressionToken_1=require("./CallExpressionToken"),peggyParser=function(){function Mr(t,r,e,n){t=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(t,Mr.prototype),t.expected=r,t.found=e,t.location=n,t.name="SyntaxError",t}function t(){this.constructor=r}var r,e;function l(t,r,e){return e=e||" ",t.length>r?t:(r-=t.length,t+(e+=e.repeat(r)).slice(0,r))}return r=Mr,e=Error,t.prototype=e.prototype,r.prototype=new t,Mr.prototype.format=function(t){var r="Error: "+this.message;if(this.location){for(var e=null,n=0;n<t.length;n++)if(t[n].source===this.location.source){e=t[n].text.split(/\r\n|\n|\r/g);break}var o,a,c,u=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(u):u,i=this.location.source+":"+s.line+":"+s.column;e?(c=this.location.end,o=l("",s.line.toString().length," "),a=e[u.line-1],c=(u.line===c.line?c.column:a.length+1)-u.column||1,r+="\n --\x3e "+i+"\n"+o+" |\n"+s.line+" | "+a+"\n"+o+" | "+l("",u.column-1," ")+l("",c,"^")):r+="\n at "+i}return r},Mr.buildMessage=function(t,r){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r=t.parts.map(function(t){return Array.isArray(t)?a(t[0])+"-"+a(t[1]):a(t)});return"["+(t.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function c(t){return e[t.type](t)}return"Expected "+function(t){var r,e,n=t.map(c);if(n.sort(),0<n.length){for(e=r=1;r<n.length;r++)n[r-1]!==n[r]&&(n[e]=n[r],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+((t=r)?'"'+o(t)+'"':"end of input")+" found."},{SyntaxError:Mr,parse:function(l,t){function $(t){return new BracketSafeExpressionToken_1.default(t,n(),L())}function U(t){return new BracketSafeExpressionToken_1.default(t,n(),L())}function z(t,r){return[t,...r.map(([,,,t])=>t)]}function B(t){return[t[0],...t[1]].join("")}function Z(t){return t.map(t=>-1<["\\'","\\\\"].indexOf(t)?t[1]:t).join("")}function M(t){return t.map(t=>-1<['\\"',"\\\\"].indexOf(t)?t[1]:t).join("")}function N(t){return t.map(([,t])=>-1<["\\`","\\\\"].indexOf(t)?t[1]:t).join("")}var f={},a=(t=void 0!==t?t:{}).grammarSource,r={Start:Fr},I=Fr,D="{{",G="}}",s="(",i=")",H="?",J=":",K="@",h=".",Q="[",V="]",W=",",X="null",Y="NULL",tt="true",rt="TRUE",et="false",nt="FALSE",ot="'",c="\\'",u="\\\\",at='"',A='\\"',ct="`",p="${",d="\\`",ut="0",st="e",it="==",o="=",lt="===",ft="!=",ht="!==",At=">",pt=">=",dt="<",gt="<=",Ct=/^[ \t\r\n]/,xt=/^[a-zA-Z_$]/,g=/^[a-zA-Z0-9_$]/,vt=/^[^']/,bt=/^[^"]/,yt=/^[^`]/,C=/^[0-9]/,x=/^[+\-]/,Et=/^[1-9]/,Tt=F("{{",!1),kt=F("}}",!1),mt={type:"any"},v=F("(",!1),b=F(")",!1),_t=F("?",!1),wt=F(":",!1),St=F("@",!1),y=F(".",!1),Lt=F("[",!1),Ft=F("]",!1),jt=F(",",!1),Ot=j([" ","\t","\r","\n"],!1,!1),Pt=j([["a","z"],["A","Z"],"_","$"],!1,!1),E=j([["a","z"],["A","Z"],["0","9"],"_","$"],!1,!1),qt=F("null",!1),Rt=F("NULL",!1),$t=F("true",!1),Ut=F("TRUE",!1),zt=F("false",!1),Bt=F("FALSE",!1),Zt=F("'",!1),Mt=F("\\'",!1),T=F("\\\\",!1),Nt=j(["'"],!0,!1),It=F('"',!1),Dt=F('\\"',!1),Gt=j(['"'],!0,!1),Ht=F("`",!1),Jt=F("${",!1),Kt=F("\\`",!1),Qt=j(["`"],!0,!1),k=j([["0","9"]],!1,!1),m=j(["+","-"],!1,!1),Vt=F("0",!1),Wt=j([["1","9"]],!1,!1),Xt=F("e",!0),Yt=F("==",!1),tr=F("=",!1),rr=F("===",!1),er=F("!=",!1),nr=F("!==",!1),or=F(">",!1),ar=F(">=",!1),cr=F("<",!1),ur=F("<=",!1),sr=function(t){return t},ir=function(){return[]},lr=function(t){return t},fr=function(){return new TextToken_1.default(n(),L())},hr=function(t,r,e){return new TernaryExpressionToken_1.default(t,r,e,n(),L())},Ar=function(t,r,e){return new ComparisonExpressionToken_1.default(t,e,r,n(),L())},pr=function(t,r,e){return new CallExpressionToken_1.CallExpressionObjectAccess(e)},dr=function(t,r,e){return new CallExpressionToken_1.CallExpressionArrayAccess(e)},gr=function(t,r,e){return new CallExpressionToken_1.CallExpressionInvocation(null!=e?e:[])},Cr=function(t,r,e){return new CallExpressionToken_1.default("@"===t,r,e,n(),L())},xr=function(t){return new LiteralToken_1.default(t,n(),L())},vr=function(t){return new LiteralToken_1.default(t,n(),L())},br=function(t){return new LiteralToken_1.default(t,n(),L())},yr=function(t){return new LiteralToken_1.default(t,n(),L())},Er=function(){return parseFloat(n())},Tr=function(){return parseFloat(n())},kr=function(){return parseFloat(n())},_=0,w=0,mr=[{line:1,column:1}],e=0,_r=[],S=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');I=r[t.startRule]}function n(){return l.substring(w,_)}function L(){return Sr(w,_)}function F(t,r){return{type:"literal",text:t,ignoreCase:r}}function j(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function wr(t){var r,e=mr[t];if(e)return e;for(r=t-1;!mr[r];)r--;for(e={line:(e=mr[r]).line,column:e.column};r<t;)10===l.charCodeAt(r)?(e.line++,e.column=1):e.column++,r++;return mr[t]=e}function Sr(t,r,e){var n=wr(t),o=wr(r),t={source:a,start:{offset:t,line:n.line,column:n.column},end:{offset:r,line:o.line,column:o.column}};return e&&a&&"function"==typeof a.offset&&(t.start=a.offset(t.start),t.end=a.offset(t.end)),t}function O(t){_<e||(e<_&&(e=_,_r=[]),_r.push(t))}function Lr(t,r,e){return new Mr(Mr.buildMessage(t,r),t,r,e)}function Fr(){var t=_,r=[],e=jr();if((e=e===f?Or():e)!==f)for(;e!==f;)r.push(e),(e=jr())===f&&(e=Or());else r=f;return r!==f&&(w=t,r=sr(r)),(t=r)===f&&(r="",w=t=_,t=r=ir()),t}function jr(){var t,r,e=_;return l.substr(_,2)===D?(t=D,_+=2):(t=f,0===S&&O(Tt)),e=t!==f&&(R(),(t=P())!==f)&&(R(),l.substr(_,2)===G?(r=G,_+=2):(r=f,0===S&&O(kt)),r!==f)?(w=e,lr(t)):(_=e,f)}function Or(){var t,r=_;return l.length>_?(t=l.charAt(_),_++):(t=f,0===S&&O(mt)),t!==f&&(w=r,t=fr()),t}function P(){var t=Pr();return t=t===f&&(t=qr())===f&&(t=Rr())===f?Ur():t}function q(){var t,r,e,n=_;return 40===l.charCodeAt(_)?(t=s,_++):(t=f,0===S&&O(v)),n=(n=t!==f&&(R(),(r=Pr())!==f)&&(R(),41===l.charCodeAt(_)?(e=i,_++):(e=f,0===S&&O(b)),e!==f)?(w=n,$(r)):(_=n,f))===f&&(n=_,40===l.charCodeAt(_)?(t=s,_++):(t=f,0===S&&O(v)),(n=t!==f&&(R(),(r=qr())!==f)&&(R(),41===l.charCodeAt(_)?(e=i,_++):(e=f,0===S&&O(b)),e!==f)?(w=n,U(r)):(_=n,f))===f)&&(n=Rr())===f?Ur():n}function Pr(){var t,r,e=_,n=q();return e=n!==f&&(R(),63===l.charCodeAt(_)?(t=H,_++):(t=f,0===S&&O(_t)),t!==f)&&(R(),(t=q())!==f)&&(R(),58===l.charCodeAt(_)?(r=J,_++):(r=f,0===S&&O(wt)),r!==f)&&(R(),(r=q())!==f)?(w=e,hr(n,t,r)):(_=e,f)}function qr(){var t,r,e=_,n=q();return e=n!==f&&(R(),(t=function(){var t,r,e,n;t=_,l.substr(_,2)===it?(r=it,_+=2):(r=f,0===S&&O(Yt));t=r!==f&&(e=_,S++,61===l.charCodeAt(_)?(n=o,_++):(n=f,0===S&&O(tr)),S--,e=n===f?void 0:(_=e,f),e!==f)?(w=t,r):(_=t,f);t===f&&(l.substr(_,3)===lt?(t=lt,_+=3):(t=f,0===S&&O(rr)),t===f)&&(t=_,l.substr(_,2)===ft?(r=ft,_+=2):(r=f,0===S&&O(er)),(t=r!==f&&(e=_,S++,61===l.charCodeAt(_)?(n=o,_++):(n=f,0===S&&O(tr)),S--,(e=n===f?void 0:(_=e,f))!==f)?(w=t,r):(_=t,f))===f)&&(l.substr(_,3)===ht?(t=ht,_+=3):(t=f,0===S&&O(nr)),t===f)&&(t=_,62===l.charCodeAt(_)?(r=At,_++):(r=f,0===S&&O(or)),(t=r!==f&&(e=_,S++,61===l.charCodeAt(_)?(n=o,_++):(n=f,0===S&&O(tr)),S--,(e=n===f?void 0:(_=e,f))!==f)?(w=t,r):(_=t,f))===f)&&(l.substr(_,2)===pt?(t=pt,_+=2):(t=f,0===S&&O(ar)),t===f)&&(t=_,60===l.charCodeAt(_)?(r=dt,_++):(r=f,0===S&&O(cr)),(t=r!==f&&(e=_,S++,61===l.charCodeAt(_)?(n=o,_++):(n=f,0===S&&O(tr)),S--,(e=n===f?void 0:(_=e,f))!==f)?(w=t,r):(_=t,f))===f)&&(l.substr(_,2)===gt?(t=gt,_+=2):(t=f,0===S&&O(ur)));return t}())!==f)&&(R(),(r=q())!==f)?(w=e,Ar(n,t,r)):(_=e,f)}function Rr(){var t,r,e,n,o,a,c,u=_;if(64===l.charCodeAt(_)?(t=K,_++):(t=f,0===S&&O(St)),t===f&&(t=null),(r=zr())!==f){for(e=[],n=_,R(),46===l.charCodeAt(_)?(o=h,_++):(o=f,0===S&&O(y)),(n=o!==f&&(R(),(a=zr())!==f)?(w=n,pr(t,r,a)):(_=n,f))===f&&(n=_,R(),91===l.charCodeAt(_)?(o=Q,_++):(o=f,0===S&&O(Lt)),(n=o!==f&&(R(),(a=P())!==f)&&(R(),93===l.charCodeAt(_)?(c=V,_++):(c=f,0===S&&O(Ft)),c!==f)?(w=n,dr(t,r,a)):(_=n,f))===f)&&(n=_,R(),40===l.charCodeAt(_)?(o=s,_++):(o=f,0===S&&O(v)),n=o!==f&&(R(),(a=$r())===f&&(a=null),R(),41===l.charCodeAt(_)?(c=i,_++):(c=f,0===S&&O(b)),c!==f)?(w=n,gr(t,r,a)):(_=n,f));n!==f;)e.push(n),n=_,R(),46===l.charCodeAt(_)?(o=h,_++):(o=f,0===S&&O(y)),(n=o!==f&&(R(),(a=zr())!==f)?(w=n,pr(t,r,a)):(_=n,f))===f&&(n=_,R(),91===l.charCodeAt(_)?(o=Q,_++):(o=f,0===S&&O(Lt)),(n=o!==f&&(R(),(a=P())!==f)&&(R(),93===l.charCodeAt(_)?(c=V,_++):(c=f,0===S&&O(Ft)),c!==f)?(w=n,dr(t,r,a)):(_=n,f))===f)&&(n=_,R(),40===l.charCodeAt(_)?(o=s,_++):(o=f,0===S&&O(v)),n=o!==f&&(R(),(a=$r())===f&&(a=null),R(),41===l.charCodeAt(_)?(c=i,_++):(c=f,0===S&&O(b)),c!==f)?(w=n,gr(t,r,a)):(_=n,f));w=u,u=Cr(t,r,e)}else _=u,u=f;return u}function $r(){var t,r,e,n,o,a,c=_,u=P();if(u!==f){for(t=[],r=_,e=R(),44===l.charCodeAt(_)?(n=W,_++):(n=f,0===S&&O(jt)),r=n!==f&&(o=R(),(a=P())!==f)?e=[e,n,o,a]:(_=r,f);r!==f;)t.push(r),r=_,e=R(),44===l.charCodeAt(_)?(n=W,_++):(n=f,0===S&&O(jt)),r=n!==f&&(o=R(),(a=P())!==f)?e=[e,n,o,a]:(_=r,f);w=c,c=z(u,t)}else _=c,c=f;return c}function Ur(){var t=_,r=Br();return r!==f&&(w=t,r=xr(r)),(t=r)===f&&(t=_,(r=Zr())!==f&&(w=t,r=vr(r)),(t=r)===f)&&(t=_,(r=function(){var t,r,e,n;t=_,t=(r=function(){var t,r,e,n,o,a,c,u,s,i;t=_,x.test(l.charAt(_))?(r=l.charAt(_),_++):(r=f,0===S&&O(m));r===f&&(r=null);48===l.charCodeAt(_)?(e=ut,_++):(e=f,0===S&&O(Vt));if(e===f)if(e=_,Et.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Wt)),n!==f){for(o=[],C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));a!==f;)o.push(a),C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));e=n=[n,o]}else _=e,e=f;if(e!==f)if(46===l.charCodeAt(_)?(n=h,_++):(n=f,0===S&&O(y)),n!==f){for(o=[],C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));a!==f;)o.push(a),C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));if(a=_,l.substr(_,1).toLowerCase()===st?(c=l.charAt(_),_++):(c=f,0===S&&O(Xt)),c!==f){if(x.test(l.charAt(_))?(u=l.charAt(_),_++):(u=f,0===S&&O(m)),u===f&&(u=null),s=[],C.test(l.charAt(_))?(i=l.charAt(_),_++):(i=f,0===S&&O(k)),i!==f)for(;i!==f;)s.push(i),C.test(l.charAt(_))?(i=l.charAt(_),_++):(i=f,0===S&&O(k));else s=f;a=s!==f?c=[c,u,s]:(_=a,f)}else _=a,a=f;a===f&&(a=null),w=t,t=Er()}else _=t,t=f;else _=t,t=f;if(t===f){if(t=_,x.test(l.charAt(_))?(r=l.charAt(_),_++):(r=f,0===S&&O(m)),r===f&&(r=null),46===l.charCodeAt(_)?(e=h,_++):(e=f,0===S&&O(y)),e!==f){if(n=[],C.test(l.charAt(_))?(o=l.charAt(_),_++):(o=f,0===S&&O(k)),o!==f)for(;o!==f;)n.push(o),C.test(l.charAt(_))?(o=l.charAt(_),_++):(o=f,0===S&&O(k));else n=f;if(n!==f){if(o=_,l.substr(_,1).toLowerCase()===st?(a=l.charAt(_),_++):(a=f,0===S&&O(Xt)),a!==f){if(x.test(l.charAt(_))?(c=l.charAt(_),_++):(c=f,0===S&&O(m)),c===f&&(c=null),u=[],C.test(l.charAt(_))?(s=l.charAt(_),_++):(s=f,0===S&&O(k)),s!==f)for(;s!==f;)u.push(s),C.test(l.charAt(_))?(s=l.charAt(_),_++):(s=f,0===S&&O(k));else u=f;o=u!==f?a=[a,c,u]:(_=o,f)}else _=o,o=f;o===f&&(o=null),w=t,t=Tr()}else _=t,t=f}else _=t,t=f;if(t===f){if(t=_,x.test(l.charAt(_))?(r=l.charAt(_),_++):(r=f,0===S&&O(m)),r===f&&(r=null),48===l.charCodeAt(_)?(e=ut,_++):(e=f,0===S&&O(Vt)),e===f)if(e=_,Et.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Wt)),n!==f){for(o=[],C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));a!==f;)o.push(a),C.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(k));e=n=[n,o]}else _=e,e=f;if(e!==f){if(n=_,l.substr(_,1).toLowerCase()===st?(o=l.charAt(_),_++):(o=f,0===S&&O(Xt)),o!==f){if(x.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(m)),a===f&&(a=null),c=[],C.test(l.charAt(_))?(u=l.charAt(_),_++):(u=f,0===S&&O(k)),u!==f)for(;u!==f;)c.push(u),C.test(l.charAt(_))?(u=l.charAt(_),_++):(u=f,0===S&&O(k));else c=f;n=c!==f?o=[o,a,c]:(_=n,f)}else _=n,n=f;n===f&&(n=null),w=t,t=kr()}else _=t,t=f}}return t}())!==f&&(e=_,S++,xt.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Pt)),n===f&&(C.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(k))),S--,e=n===f?void 0:(_=e,f),e!==f)?(w=t,r):(_=t,f);return t}())!==f&&(w=t,r=br(r)),(t=r)===f)&&(t=_,(r=function(){var t,r,e,n,o,a;t=_,39===l.charCodeAt(_)?(r=ot,_++):(r=f,0===S&&O(Zt));if(r!==f){for(e=[],l.substr(_,2)===c?(n=c,_+=2):(n=f,0===S&&O(Mt)),n===f&&(l.substr(_,2)===u?(n=u,_+=2):(n=f,0===S&&O(T)),n===f)&&(vt.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Nt)));n!==f;)e.push(n),l.substr(_,2)===c?(n=c,_+=2):(n=f,0===S&&O(Mt)),n===f&&(l.substr(_,2)===u?(n=u,_+=2):(n=f,0===S&&O(T)),n===f)&&(vt.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Nt)));39===l.charCodeAt(_)?(n=ot,_++):(n=f,0===S&&O(Zt)),t=n!==f?(w=t,Z(e)):(_=t,f)}else _=t,t=f;if(t===f){if(t=_,34===l.charCodeAt(_)?(r=at,_++):(r=f,0===S&&O(It)),r!==f){for(e=[],l.substr(_,2)===A?(n=A,_+=2):(n=f,0===S&&O(Dt)),n===f&&(l.substr(_,2)===u?(n=u,_+=2):(n=f,0===S&&O(T)),n===f)&&(bt.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Gt)));n!==f;)e.push(n),l.substr(_,2)===A?(n=A,_+=2):(n=f,0===S&&O(Dt)),n===f&&(l.substr(_,2)===u?(n=u,_+=2):(n=f,0===S&&O(T)),n===f)&&(bt.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(Gt)));34===l.charCodeAt(_)?(n=at,_++):(n=f,0===S&&O(It)),t=n!==f?(w=t,M(e)):(_=t,f)}else _=t,t=f;if(t===f)if(t=_,96===l.charCodeAt(_)?(r=ct,_++):(r=f,0===S&&O(Ht)),r!==f){for(e=[],o=n=_,S++,l.substr(_,2)===p?(a=p,_+=2):(a=f,0===S&&O(Jt)),S--,o=a===f?void 0:(_=o,f),n=o!==f&&(l.substr(_,2)===d?(a=d,_+=2):(a=f,0===S&&O(Kt)),a===f&&(l.substr(_,2)===u?(a=u,_+=2):(a=f,0===S&&O(T)),a===f)&&(yt.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(Qt))),a!==f)?o=[o,a]:(_=n,f);n!==f;)e.push(n),o=n=_,S++,l.substr(_,2)===p?(a=p,_+=2):(a=f,0===S&&O(Jt)),S--,o=a===f?void 0:(_=o,f),n=o!==f&&(l.substr(_,2)===d?(a=d,_+=2):(a=f,0===S&&O(Kt)),a===f&&(l.substr(_,2)===u?(a=u,_+=2):(a=f,0===S&&O(T)),a===f)&&(yt.test(l.charAt(_))?(a=l.charAt(_),_++):(a=f,0===S&&O(Qt))),a!==f)?o=[o,a]:(_=n,f);96===l.charCodeAt(_)?(n=ct,_++):(n=f,0===S&&O(Ht)),t=n!==f?(w=t,N(e)):(_=t,f)}else _=t,t=f}return t}())!==f&&(w=t,r=yr(r)),t=r),t}function R(){var t,r=[];for(Ct.test(l.charAt(_))?(t=l.charAt(_),_++):(t=f,0===S&&O(Ot));t!==f;)r.push(t),Ct.test(l.charAt(_))?(t=l.charAt(_),_++):(t=f,0===S&&O(Ot));return r}function zr(){var t,r,e,n,o=_,a=_;if(S++,t=function(){var t;(t=Br())===f&&(t=Zr());return t}(),S--,(a=t===f?void 0:(_=a,f))!==f){if(t=_,xt.test(l.charAt(_))?(r=l.charAt(_),_++):(r=f,0===S&&O(Pt)),r!==f){for(e=[],g.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(E));n!==f;)e.push(n),g.test(l.charAt(_))?(n=l.charAt(_),_++):(n=f,0===S&&O(E));t=r=[r,e]}else _=t,t=f;o=t!==f?(w=o,B(t)):(_=o,f)}else _=o,o=f;return o}function Br(){var t,r,e,n=_;return l.substr(_,4)===X?(t=X,_+=4):(t=f,0===S&&O(qt)),(n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,null):(_=n,f))===f&&(n=_,l.substr(_,4)===Y?(t=Y,_+=4):(t=f,0===S&&O(Rt)),n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,null):(_=n,f)),n}function Zr(){var t,r,e,n=_;return l.substr(_,4)===tt?(t=tt,_+=4):(t=f,0===S&&O($t)),(n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,!0):(_=n,f))===f&&(n=_,l.substr(_,4)===rt?(t=rt,_+=4):(t=f,0===S&&O(Ut)),(n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,!0):(_=n,f))===f)&&(n=_,l.substr(_,5)===et?(t=et,_+=5):(t=f,0===S&&O(zt)),(n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,!1):(_=n,f))===f)&&(n=_,l.substr(_,5)===nt?(t=nt,_+=5):(t=f,0===S&&O(Bt)),n=t!==f&&(r=_,S++,g.test(l.charAt(_))?(e=l.charAt(_),_++):(e=f,0===S&&O(E)),S--,(r=e===f?void 0:(_=r,f))!==f)?(w=n,!1):(_=n,f)),n}if((r=I())!==f&&_===l.length)return r;throw r!==f&&_<l.length&&O({type:"end"}),Lr(_r,e<l.length?l.charAt(e):null,e<l.length?Sr(e,e+1):Sr(e,e))}}}(),parse=(peggyParser.SyntaxError.prototype.name="PeggySyntaxError",peggyParser.parse),PeggySyntaxError=peggyParser.SyntaxError;exports.default=parse;